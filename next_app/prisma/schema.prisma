generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Request {
  id               Int      @id @default(autoincrement())
  user_prompt      String?  @map("user_prompt")
  image_references String?  @map("image_references") // Stored as JSON string
  status           String   @default("Queued") // Enum: Queued, Processing, Completed, Failed
  error_message    String?  @map("error_message")
  created_at       DateTime @default(now()) @map("created_at")
  updated_at       DateTime @default(now()) @updatedAt @map("updated_at")
  gpt_raw_response String?  @map("gpt_raw_response") // Stored as JSON string
  is_success       Boolean  @default(false) @map("is_success")

  @@map("request")
}

model AdminUser {
  id              Int     @id @default(autoincrement())
  username        String  @unique
  hashed_password String  @map("hashed_password")
  is_active       Boolean @default(true) @map("is_active")

  @@map("admin_user")
}

model Setting {
  id    Int     @id @default(autoincrement())
  key   String  @unique
  value String?

  @@map("setting")
}

model Log {
  id        Int      @id @default(autoincrement())
  timestamp DateTime @default(now())
  level     String   // Enum: DEBUG, INFO, WARNING, ERROR
  message   String
  source    String?
  context   String?  // Stored as JSON string

  @@index([timestamp(sort: Desc)])
  @@index([level])
  @@index([source])
  @@map("logs")
}
